generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// User profiles with admin status
model Profile {
  id            String   @id @default(cuid())
  userId        String   @unique // InstantDB user ID
  displayName   String?
  isAdmin       Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("profiles")
}

// Country data (population and groups)
model Country {
  id              String   @id @default(cuid())
  name            String
  slug            String   @unique
  population      String
  groups          Int      @default(12)
  photoUrl        String?
  countryDetails  String?  @db.Text
  primaryContacts String?  @db.Text
  adminNotes      String?  @db.Text
  flag            String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  notes          Note[]
  galleryImages  GalleryImage[]

  @@map("countries")
}

// User notes for each country
model Note {
  id          String   @id @default(cuid())
  userId      String
  countrySlug String
  content     String   @db.Text
  updatedAt   DateTime

  country     Country  @relation(fields: [countrySlug], references: [slug], onDelete: Cascade)

  @@unique([userId, countrySlug])
  @@map("notes")
}

// Gallery images for each country
model GalleryImage {
  id          String   @id @default(cuid())
  countrySlug String
  imageUrl    String
  order       Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  country     Country  @relation(fields: [countrySlug], references: [slug], onDelete: Cascade)

  @@map("gallery_images")
}
